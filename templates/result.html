<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>選課幫手 - 查詢結果</title>
    {% include "font.html" %}
    <style>
        /* Show it is fixed to the top */
        body {
            padding-top: 4.5rem;
        }

        #warning li {
            padding-bottom: 0.5rem;
        }

        #warning li:last-child {
            padding-bottom: 0;
        }

    </style>
</head>
<body>
{% include 'navbar.html' %}
<div class="container min-vh-100">
    <div id="title" class="fs-2 lh-lg text-center position-relative" style="color: var(--bs-purple)">
        課程查詢結果
    </div>
    <div class="table-responsive">
        <table class="table table-sm table-bordered table-hover text-nowrap text-center align-middle">
            <caption class="caption-top sticky-top" style="padding: 1rem;">
                <span id="update_time" class="badge bg-secondary position-absolute top-50 end-0 translate-middle-y">
                </span>
            </caption>
            <thead class="table-info">
            <tr>
                <th scope="col">選擇</th>
                <th scope="col" style="width: 20px">
                    <span class="invisible">./</span>
                    班級
                    <span class="invisible">./</span>
                </th>
                <th scope="col">選課<br>代號</th>
                <th scope="col" style="width: 80px">
                    <span class="invisible">.　</span>
                    類別
                    <span class="invisible">.　</span>
                </th>
                <th scope="col">
                    <span class="invisible">　　　</span>
                    科目
                    <span class="invisible">　　　</span>
                </th>
                <th scope="col">學分</th>
                <th scope="col">學年<br>學期</th>
                <th scope="col">必修<br>選修</th>
                <th scope="col">授課<br>時數</th>
                <th scope="col" colspan="3">人數<br>上限 / 下限 / 已選</th>
                <th scope="col">校區</th>
                <th scope="col">授課教師</th>
                <th scope="col">上課時間</th>
                <th scope="col">備註</th>
            </tr>
            </thead>
            <tbody>
            {% for class in classes %}
                <tr>
                    <th scope="col"></th>
                    <td class="text-wrap">{{ class.class_name }}</td>
                    <td>
                        <form name="form" method="post" target="new"
                              action="http://shcourse.utaipei.edu.tw/utaipei/ag_pro/ag064_print.jsp">
                            <input type="hidden" name="arg01" value="{{ year }}">
                            <input type="hidden" name="arg02" value="{{ semester }}">
                            <input type="hidden" name="arg04" value="{{ class.syllabus }}">
                            <a href="#" class="link-primary"
                               onclick="this.parentNode.submit();">{{ class.id }}</a>
                        </form>
                    </td>
                    <td class="text-wrap">{{ class.category }}</td>
                    <td class="text-wrap">
                        <div data-bs-toggle="tooltip"
                             data-bs-placement="top" title="{{ class.english_name }}">
                            {{ class.chinese_name }}
                        </div>
                    </td>
                    <td>{{ class.points }}</td>
                    <td>{{ class.full_half }}</td>
                    <td>{{ class.req_select }}</td>
                    <td>{{ class.hours }}</td>
                    <td>{{ class.enrolled_max }}</td>
                    <td>{{ class.enrolled_min }}</td>
                    <td>{{ class.enrolled_current }}</td>
                    <td>{{ class.campus }}</td>
                    <td>
                        {% for teacher in class.teachers %}
                            {{ teacher.name }}
                            {% if not loop.last %}
                                <br>
                            {% endif %}
                        {% endfor %}
                    </td>
                    <td>
                        {% for c in class.times %}
                            {{ c[0] }}
                            <span>
                                {% for time in c[1] %}
                                    {{ time }}{{ ", " if not loop.last else "" }}
                                {% endfor %}
                                {% if not loop.last %}
                                    <br>
                                {% endif %}
                            </span>
                        {% endfor %}
                    </td>
                    <td>
                        {% if class.notes != ' ' %}
                            <div class="text-center" data-bs-toggle="tooltip"
                                 data-bs-placement="top" title="{{ class.notes }}">
                                <div class="bi bi-exclamation-circle"></div>
                            </div>
                        {% endif %}
                        {% if class.limit %}
                            <form name="notes" method="post" target="new"
                                  action="http://shcourse.utaipei.edu.tw/utaipei/ag_pro/ag203_limit.jsp">
                                <input type="hidden" name="ls_year" value="{{ year }}">
                                <input type="hidden" name="ls_sms" value="{{ semester }}">
                                <input type="hidden" name="data" value="{{ class.id }}">
                                <a href="#" class="link" onclick="this.parentNode.submit();">
                                    限修
                                </a>
                            </form>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
            </tbody>
            <tfoot>
            <tr>
                <td class="table" colspan="17">總共列出了 {{ total }} 堂課</td>
            </tr>
            </tfoot>
        </table>
    </div>
</div>
{% include 'footerjs.html' %}
<script>
    (() => {
        $.getJSON("{{ url_for("api.update_time") }}", function (data) {
            if (data.key !== "error") {
                let time = new Date(data.time + "+0000")
                $("#update_time").text("最後更新時間: " + time);
            }
        });
    })()
</script>
</body>
</html>